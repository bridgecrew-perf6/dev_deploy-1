<?phpnamespace Nemundo\Meteo\MeteoschweizAllgemeineLage\Crawler;use Nemundo\App\SystemLog\Message\SystemLogMessage;use Nemundo\Core\Base\AbstractBaseClass;use Nemundo\Core\Http\Response\StatusCode;use Nemundo\Core\RegularExpression\RegularExpressionReader;use Nemundo\Core\Type\DateTime\DateTime;use Nemundo\Core\Type\DateTime\Time;use Nemundo\Core\Type\Text\Text;use Nemundo\Core\WebRequest\CurlWebRequest;use Nemundo\Meteo\MeteoschweizAllgemeineLage\Application\MeteoschweizAllgemeineLageApplication;class AllgemeineLageCrawler extends AbstractBaseClass{    /**     * @var string     */    public $datumText;    /**     * @var DateTime     */    public $datum;    /**     * @var string     */    public $allgemeineLage;    /**     * @var string     */    //private $frontenkarteUrl;    public $frontenkarteUrl;    /**     * @var CurlWebRequest     */    private $http;    public function __construct()    {        $this->http = new CurlWebRequest();        $url = 'https://www.meteoschweiz.admin.ch/home/wetter/prognosen/allgemeine-lage.html';        $response = $this->http->getUrl($url);        if ($response->statusCode == StatusCode::OK) {            $re = '<div class="textFCK">.*?<p>.*?Aktualisiert am (.*?)</p>.*?<p>(.*?)</p>.*?<h3>Frontenkarte</h3>.*?<a href="(.*?)"';            $crawler = new RegularExpressionReader();            $crawler->text = $response->html;            $crawler->regularExpression = $re;            if ($crawler->hasItems()) {                $item = $crawler->getDataRow();                $this->datumText = $item->getValue(0);                $list = (new Text($this->datumText))                    ->remove('Uhr')                    ->split(',');                $this->datum = new DateTime();                $this->datum->fromGermanLongFormat($list[1]);                $this->datum->setTime((new Time($list[2])));                //Dienstag, 09. Februar 2021, 09:47 Uhr                //(new Debug())->write($this->datum);                $this->allgemeineLage = html_entity_decode($item->getValue(1));                $this->frontenkarteUrl = 'http://www.meteoschweiz.admin.ch' . $item->getValue(2);            }        } else {            (new SystemLogMessage(new MeteoschweizAllgemeineLageApplication()))->logError($response->errorMessage);        }    }    public function downloadFrontenkarte($destinationFilename)    {        $this->http->downloadUrl($this->frontenkarteUrl, $destinationFilename);    }}