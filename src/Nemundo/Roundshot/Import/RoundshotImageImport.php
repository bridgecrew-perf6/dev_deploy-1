<?phpnamespace Paranautik\App\Roundshot\Import;use Nemundo\App\Script\Type\AbstractConsoleScript;use Paranautik\App\Roundshot\Data\RoundshotDownload\RoundshotDownloadReader;use Paranautik\App\Roundshot\Download\ImageListDownload;class RoundshotImageImport extends AbstractConsoleScript{    protected function loadScript()    {        $this->scriptName = 'roundshot-image';    }    public function run()    {        $downloadReader = new RoundshotDownloadReader();        $downloadReader->filter->andEqual($downloadReader->model->download, false);        foreach ($downloadReader->getData() as $downloadRow) {            $download = new ImageListDownload();            $download->roundshotId = $downloadRow->roundshotId;            $download->date = $downloadRow->date;            $download->download();        }        // https://storage.roundshot.com/53a974414ddfe7.48910878/2018-11-13/16-23-00/2018-11-13-16-23-00_half.jpg        // https://storage.roundshot.com/53a974414ddfe7.48910878/2018-11-13/16-23-00/2018-11-13-16-23-00_half.jpg        //$timestamp = 1542119400;        /*        $roundshotUrl = 'https://pilatus.roundshot.com/';        $url = $roundshotUrl . 'structure.json?days=0&to=2018-11-13T23%3A59%3A59.999Z';        $jsonReader = new JsonReader();        $jsonReader->fromUrl($url);        foreach ($jsonReader->getData()['images'] as $image) {            $timestamp = $image['datetime'];            $dateTime = (new DateTime())->fromTimestamp($timestamp);            (new Debug())->write($dateTime->getLongFormatWithWeekday());            $halfUrl = $image['structure']['half']['url_full'];            /*            $halfUrl = (new Text($image['structure']['half']['url_full']))                ->replace('http://', 'https://')                ->getValue();*/        /*  (new Debug())->write($halfUrl);          $filename = (new Path())              ->addPath(ProjectConfig::$tmpPath)              ->addPath('roundshot')              ->addPath((new Text($dateTime->getIsoDateFormat()))->replace(':', '-')->getValue() . '.jpg')              ->getFilename();          $download = new WebRequestCurl();          //$download->          $download->downloadUrl($halfUrl, $filename);      }      // json      // https://pilatus.roundshot.com/structure.json?days=0&to=2018-11-13T23%3A59%3A59.999Z// https://fliegen.roundshot.com/structure.json?days=0&to=2018-11-13T23%3A59%3A59.999Z      // https://storage.roundshot.com/53ce6af5ae1835.21533240/2018-11-13/08-50-00/2018-11-13-08-50-00_half.jpg      // https://storage.roundshot.com/53ce6af5ae1835.21533240/2018-11-13/16-40-00/2018-11-13-16-40-00_half.jpg      // https://storage.roundshot.com/53ce6af5ae1835.21533240/2018-11-13/09-10-00/2018-11-13-09-00-00_half.jpg*/    }}